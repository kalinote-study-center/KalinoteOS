     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .text]
    10 00000000                                 	GLOBAL	_shtctl_init
    11 00000000                                 _shtctl_init:
    12 00000000 55                              	PUSH	EBP
    13 00000001 89 E5                           	MOV	EBP,ESP
    14 00000003 57                              	PUSH	EDI
    15 00000004 56                              	PUSH	ESI
    16 00000005 53                              	PUSH	EBX
    17 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    18 00000009 68 00003418                     	PUSH	13336
    19 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    20 00000011 56                              	PUSH	ESI
    21 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    22 00000017 89 C3                           	MOV	EBX,EAX
    23 00000019 58                              	POP	EAX
    24 0000001A 5A                              	POP	EDX
    25 0000001B 85 DB                           	TEST	EBX,EBX
    26 0000001D 74 54                           	JE	L3
    27 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    28 00000022 0F AF C7                        	IMUL	EAX,EDI
    29 00000025 C1 E0 02                        	SAL	EAX,2
    30 00000028 50                              	PUSH	EAX
    31 00000029 56                              	PUSH	ESI
    32 0000002A E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002F 85 C0                           	TEST	EAX,EAX
    34 00000031 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000034 5A                              	POP	EDX
    36 00000035 59                              	POP	ECX
    37 00000036 74 45                           	JE	L11
    38 00000038 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 0000003B 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003E 89 03                           	MOV	DWORD [EBX],EAX
    41 00000040 8D 93 00002FD0                  	LEA	EDX,DWORD [12240+EBX]
    42 00000046 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000049 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 0000004C 89 D8                           	MOV	EAX,EBX
    45 0000004E C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000055 C7 43 14 00000000               	MOV	DWORD [20+EBX],0
    47 0000005C                                 L9:
    48 0000005C C7 80 00000434 00000000         	MOV	DWORD [1076+EAX],0
    49 00000066 89 98 00000438                  	MOV	DWORD [1080+EAX],EBX
    50 0000006C 83 C0 30                        	ADD	EAX,48
    51 0000006F 39 D0                           	CMP	EAX,EDX
    52 00000071 7E E9                           	JLE	L9
    53 00000073                                 L3:
    54 00000073 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    55 00000076 89 D8                           	MOV	EAX,EBX
    56 00000078 5B                              	POP	EBX
    57 00000079 5E                              	POP	ESI
    58 0000007A 5F                              	POP	EDI
    59 0000007B 5D                              	POP	EBP
    60 0000007C C3                              	RET
    61 0000007D                                 L11:
    62 0000007D 68 00003418                     	PUSH	13336
    63 00000082 53                              	PUSH	EBX
    64 00000083 56                              	PUSH	ESI
    65 00000084 E8 [00000000]                   	CALL	_memman_free_4k
    66 00000089 83 C4 0C                        	ADD	ESP,12
    67 0000008C EB E5                           	JMP	L3
    68 0000008E                                 	GLOBAL	_sheet_alloc
    69 0000008E                                 _sheet_alloc:
    70 0000008E 55                              	PUSH	EBP
    71 0000008F 31 D2                           	XOR	EDX,EDX
    72 00000091 89 E5                           	MOV	EBP,ESP
    73 00000093 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    74 00000096 05 00000418                     	ADD	EAX,1048
    75 0000009B                                 L18:
    76 0000009B 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    77 0000009F 74 10                           	JE	L21
    78 000000A1 42                              	INC	EDX
    79 000000A2 83 C0 30                        	ADD	EAX,48
    80 000000A5 81 FA 000000FF                  	CMP	EDX,255
    81 000000AB 7E EE                           	JLE	L18
    82 000000AD 31 C0                           	XOR	EAX,EAX
    83 000000AF                                 L12:
    84 000000AF 5D                              	POP	EBP
    85 000000B0 C3                              	RET
    86 000000B1                                 L21:
    87 000000B1 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    88 000000B8 C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    89 000000BF C7 40 28 00000000               	MOV	DWORD [40+EAX],0
    90 000000C6 C7 40 2C 00000000               	MOV	DWORD [44+EAX],0
    91 000000CD C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    92 000000D4 EB D9                           	JMP	L12
    93 000000D6                                 	GLOBAL	_sheet_setbuf
    94 000000D6                                 _sheet_setbuf:
    95 000000D6 55                              	PUSH	EBP
    96 000000D7 89 E5                           	MOV	EBP,ESP
    97 000000D9 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    98 000000DC 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    99 000000DF 89 02                           	MOV	DWORD [EDX],EAX
   100 000000E1 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   101 000000E4 89 42 04                        	MOV	DWORD [4+EDX],EAX
   102 000000E7 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   103 000000EA 89 42 08                        	MOV	DWORD [8+EDX],EAX
   104 000000ED 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   105 000000F0 89 42 14                        	MOV	DWORD [20+EDX],EAX
   106 000000F3 5D                              	POP	EBP
   107 000000F4 C3                              	RET
   108 000000F5                                 	GLOBAL	_sheet_refreshmap
   109 000000F5                                 _sheet_refreshmap:
   110 000000F5 55                              	PUSH	EBP
   111 000000F6 89 E5                           	MOV	EBP,ESP
   112 000000F8 57                              	PUSH	EDI
   113 000000F9 56                              	PUSH	ESI
   114 000000FA 53                              	PUSH	EBX
   115 000000FB 83 EC 28                        	SUB	ESP,40
   116 000000FE 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   117 00000101 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   118 00000105 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   119 00000108 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   120 0000010B 0F 88 00000179                  	JS	L68
   121 00000111                                 L24:
   122 00000111 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   123 00000115 0F 88 00000163                  	JS	L69
   124 0000011B                                 L25:
   125 0000011B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   126 0000011E 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   127 00000121 39 45 14                        	CMP	DWORD [20+EBP],EAX
   128 00000124 7E 03                           	JLE	L26
   129 00000126 89 45 14                        	MOV	DWORD [20+EBP],EAX
   130 00000129                                 L26:
   131 00000129 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   132 0000012C 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   133 0000012F 39 45 18                        	CMP	DWORD [24+EBP],EAX
   134 00000132 7E 03                           	JLE	L27
   135 00000134 89 45 18                        	MOV	DWORD [24+EBP],EAX
   136 00000137                                 L27:
   137 00000137 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   138 0000013A 8B 75 1C                        	MOV	ESI,DWORD [28+EBP]
   139 0000013D 89 75 F0                        	MOV	DWORD [-16+EBP],ESI
   140 00000140 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   141 00000143 0F 8F 000000D7                  	JG	L61
   142 00000149                                 L59:
   143 00000149 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   144 0000014C 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   145 0000014F 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   146 00000152 8B 7C 93 18                     	MOV	EDI,DWORD [24+EBX+EDX*4]
   147 00000156 89 F8                           	MOV	EAX,EDI
   148 00000158 29 D8                           	SUB	EAX,EBX
   149 0000015A 8B 37                           	MOV	ESI,DWORD [EDI]
   150 0000015C 2D 00000418                     	SUB	EAX,1048
   151 00000161 8B 57 10                        	MOV	EDX,DWORD [16+EDI]
   152 00000164 C1 F8 04                        	SAR	EAX,4
   153 00000167 89 75 DC                        	MOV	DWORD [-36+EBP],ESI
   154 0000016A 69 C0 AAAAAAAB                  	IMUL	EAX,EAX,-1431655765
   155 00000170 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   156 00000173 29 D1                           	SUB	ECX,EDX
   157 00000175 29 D6                           	SUB	ESI,EDX
   158 00000177 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   159 0000017A 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   160 0000017D 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   161 00000180 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   162 00000183 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   163 00000186 29 C3                           	SUB	EBX,EAX
   164 00000188 29 C2                           	SUB	EDX,EAX
   165 0000018A 89 5D E4                        	MOV	DWORD [-28+EBP],EBX
   166 0000018D 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   167 00000190 0F 88 000000DC                  	JS	L70
   168 00000196                                 L32:
   169 00000196 85 C9                           	TEST	ECX,ECX
   170 00000198 0F 88 000000CD                  	JS	L71
   171 0000019E                                 L33:
   172 0000019E 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   173 000001A1 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   174 000001A4 7E 03                           	JLE	L34
   175 000001A6 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   176 000001A9                                 L34:
   177 000001A9 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   178 000001AC 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   179 000001AF 7E 03                           	JLE	L35
   180 000001B1 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   181 000001B4                                 L35:
   182 000001B4 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   183 000001B8 74 6E                           	JE	L72
   184 000001BA 89 CB                           	MOV	EBX,ECX
   185 000001BC 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   186 000001BF 7D 4D                           	JGE	L30
   187 000001C1                                 L58:
   188 000001C1 8B 77 10                        	MOV	ESI,DWORD [16+EDI]
   189 000001C4 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   190 000001C7 01 DE                           	ADD	ESI,EBX
   191 000001C9 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   192 000001CC 89 75 EC                        	MOV	DWORD [-20+EBP],ESI
   193 000001CF 7D 37                           	JGE	L67
   194 000001D1                                 L57:
   195 000001D1 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   196 000001D4 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   197 000001D7 01 C8                           	ADD	EAX,ECX
   198 000001D9 8B 77 14                        	MOV	ESI,DWORD [20+EDI]
   199 000001DC 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   200 000001DF 89 D8                           	MOV	EAX,EBX
   201 000001E1 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   202 000001E5 01 C8                           	ADD	EAX,ECX
   203 000001E7 39 34 82                        	CMP	DWORD [EDX+EAX*4],ESI
   204 000001EA 74 16                           	JE	L54
   205 000001EC 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   206 000001EF 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   207 000001F2 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   208 000001F5 0F AF 42 08                     	IMUL	EAX,DWORD [8+EDX]
   209 000001F9 03 45 CC                        	ADD	EAX,DWORD [-52+EBP]
   210 000001FC 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   211 000001FF 89 14 86                        	MOV	DWORD [ESI+EAX*4],EDX
   212 00000202                                 L54:
   213 00000202 41                              	INC	ECX
   214 00000203 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   215 00000206 7C C9                           	JL	L57
   216 00000208                                 L67:
   217 00000208 43                              	INC	EBX
   218 00000209 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   219 0000020C 7C B3                           	JL	L58
   220 0000020E                                 L30:
   221 0000020E 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   222 00000211 FF 45 F0                        	INC	DWORD [-16+EBP]
   223 00000214 8B 5D F0                        	MOV	EBX,DWORD [-16+EBP]
   224 00000217 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   225 0000021A 0F 8E FFFFFF29                  	JLE	L59
   226 00000220                                 L61:
   227 00000220 83 C4 28                        	ADD	ESP,40
   228 00000223 5B                              	POP	EBX
   229 00000224 5E                              	POP	ESI
   230 00000225 5F                              	POP	EDI
   231 00000226 5D                              	POP	EBP
   232 00000227 C3                              	RET
   233 00000228                                 L72:
   234 00000228 89 CB                           	MOV	EBX,ECX
   235 0000022A 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   236 0000022D 7D DF                           	JGE	L30
   237 0000022F                                 L46:
   238 0000022F 8B 77 10                        	MOV	ESI,DWORD [16+EDI]
   239 00000232 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   240 00000235 01 DE                           	ADD	ESI,EBX
   241 00000237 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   242 0000023A 89 75 EC                        	MOV	DWORD [-20+EBP],ESI
   243 0000023D 7D 24                           	JGE	L64
   244 0000023F                                 L45:
   245 0000023F 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   246 00000242 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   247 00000245 01 C8                           	ADD	EAX,ECX
   248 00000247 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   249 0000024A 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   250 0000024D 41                              	INC	ECX
   251 0000024E 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   252 00000251 0F AF 42 08                     	IMUL	EAX,DWORD [8+EDX]
   253 00000255 03 45 CC                        	ADD	EAX,DWORD [-52+EBP]
   254 00000258 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   255 0000025B 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   256 0000025E 89 14 86                        	MOV	DWORD [ESI+EAX*4],EDX
   257 00000261 7C DC                           	JL	L45
   258 00000263                                 L64:
   259 00000263 43                              	INC	EBX
   260 00000264 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   261 00000267 7C C6                           	JL	L46
   262 00000269 EB A3                           	JMP	L30
   263 0000026B                                 L71:
   264 0000026B 31 C9                           	XOR	ECX,ECX
   265 0000026D E9 FFFFFF2C                     	JMP	L33
   266 00000272                                 L70:
   267 00000272 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   268 00000279 E9 FFFFFF18                     	JMP	L32
   269 0000027E                                 L69:
   270 0000027E C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   271 00000285 E9 FFFFFE91                     	JMP	L25
   272 0000028A                                 L68:
   273 0000028A C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   274 00000291 E9 FFFFFE7B                     	JMP	L24
   275 00000296                                 	GLOBAL	_sheet_refreshsub
   276 00000296                                 _sheet_refreshsub:
   277 00000296 55                              	PUSH	EBP
   278 00000297 89 E5                           	MOV	EBP,ESP
   279 00000299 57                              	PUSH	EDI
   280 0000029A 56                              	PUSH	ESI
   281 0000029B 53                              	PUSH	EBX
   282 0000029C 83 EC 2C                        	SUB	ESP,44
   283 0000029F 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   284 000002A2 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   285 000002A5 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   286 000002A9 8B 00                           	MOV	EAX,DWORD [EAX]
   287 000002AB 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   288 000002AE 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   289 000002B1 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   290 000002B4 0F 88 00000133                  	JS	L104
   291 000002BA                                 L74:
   292 000002BA 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   293 000002BE 0F 88 0000011D                  	JS	L105
   294 000002C4                                 L75:
   295 000002C4 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   296 000002C7 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   297 000002CA 39 45 14                        	CMP	DWORD [20+EBP],EAX
   298 000002CD 7E 03                           	JLE	L76
   299 000002CF 89 45 14                        	MOV	DWORD [20+EBP],EAX
   300 000002D2                                 L76:
   301 000002D2 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   302 000002D5 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   303 000002D8 39 45 18                        	CMP	DWORD [24+EBP],EAX
   304 000002DB 7E 03                           	JLE	L77
   305 000002DD 89 45 18                        	MOV	DWORD [24+EBP],EAX
   306 000002E0                                 L77:
   307 000002E0 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   308 000002E3 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   309 000002E6 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   310 000002E9 39 D0                           	CMP	EAX,EDX
   311 000002EB 0F 8F 000000BC                  	JG	L99
   312 000002F1                                 L97:
   313 000002F1 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   314 000002F4 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   315 000002F7 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   316 000002FA 8B 5C B7 18                     	MOV	EBX,DWORD [24+EDI+ESI*4]
   317 000002FE 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   318 00000301 8B 03                           	MOV	EAX,DWORD [EBX]
   319 00000303 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   320 00000306 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   321 00000309 29 D1                           	SUB	ECX,EDX
   322 0000030B 89 D8                           	MOV	EAX,EBX
   323 0000030D 29 F8                           	SUB	EAX,EDI
   324 0000030F 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   325 00000312 2D 00000418                     	SUB	EAX,1048
   326 00000317 29 D7                           	SUB	EDI,EDX
   327 00000319 C1 F8 04                        	SAR	EAX,4
   328 0000031C 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   329 0000031F 69 C0 AAAAAAAB                  	IMUL	EAX,EAX,-1431655765
   330 00000325 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   331 00000328 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   332 0000032B 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   333 0000032E 29 C6                           	SUB	ESI,EAX
   334 00000330 29 C2                           	SUB	EDX,EAX
   335 00000332 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   336 00000335 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   337 00000338 0F 88 00000097                  	JS	L106
   338 0000033E                                 L82:
   339 0000033E 85 C9                           	TEST	ECX,ECX
   340 00000340 0F 88 00000088                  	JS	L107
   341 00000346                                 L83:
   342 00000346 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   343 00000349 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   344 0000034C 7E 03                           	JLE	L84
   345 0000034E 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   346 00000351                                 L84:
   347 00000351 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   348 00000354 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   349 00000357 7E 03                           	JLE	L85
   350 00000359 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   351 0000035C                                 L85:
   352 0000035C 89 CE                           	MOV	ESI,ECX
   353 0000035E 3B 4D C8                        	CMP	ECX,DWORD [-56+EBP]
   354 00000361 7D 3B                           	JGE	L101
   355 00000363                                 L96:
   356 00000363 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   357 00000366 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   358 00000369 01 F7                           	ADD	EDI,ESI
   359 0000036B 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   360 0000036E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   361 00000371 7D 25                           	JGE	L103
   362 00000373                                 L95:
   363 00000373 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   364 00000376 8B 7D EC                        	MOV	EDI,DWORD [-20+EBP]
   365 00000379 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   366 0000037C 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   367 00000380 01 C8                           	ADD	EAX,ECX
   368 00000382 8B 55 D8                        	MOV	EDX,DWORD [-40+EBP]
   369 00000385 01 F8                           	ADD	EAX,EDI
   370 00000387 8B 7D D4                        	MOV	EDI,DWORD [-44+EBP]
   371 0000038A 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   372 0000038D 39 3C 82                        	CMP	DWORD [EDX+EAX*4],EDI
   373 00000390 74 23                           	JE	L108
   374 00000392                                 L92:
   375 00000392 41                              	INC	ECX
   376 00000393 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   377 00000396 7C DB                           	JL	L95
   378 00000398                                 L103:
   379 00000398 46                              	INC	ESI
   380 00000399 3B 75 C8                        	CMP	ESI,DWORD [-56+EBP]
   381 0000039C 7C C5                           	JL	L96
   382 0000039E                                 L101:
   383 0000039E 8B 75 20                        	MOV	ESI,DWORD [32+EBP]
   384 000003A1 FF 45 F0                        	INC	DWORD [-16+EBP]
   385 000003A4 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   386 000003A7 0F 8E FFFFFF44                  	JLE	L97
   387 000003AD                                 L99:
   388 000003AD 83 C4 2C                        	ADD	ESP,44
   389 000003B0 5B                              	POP	EBX
   390 000003B1 5E                              	POP	ESI
   391 000003B2 5F                              	POP	EDI
   392 000003B3 5D                              	POP	EBP
   393 000003B4 C3                              	RET
   394 000003B5                                 L108:
   395 000003B5 89 F0                           	MOV	EAX,ESI
   396 000003B7 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   397 000003BA 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   398 000003BE 01 C8                           	ADD	EAX,ECX
   399 000003C0 8B 7D CC                        	MOV	EDI,DWORD [-52+EBP]
   400 000003C3 8B 04 82                        	MOV	EAX,DWORD [EDX+EAX*4]
   401 000003C6 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   402 000003C9 89 04 BA                        	MOV	DWORD [EDX+EDI*4],EAX
   403 000003CC EB C4                           	JMP	L92
   404 000003CE                                 L107:
   405 000003CE 31 C9                           	XOR	ECX,ECX
   406 000003D0 E9 FFFFFF71                     	JMP	L83
   407 000003D5                                 L106:
   408 000003D5 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   409 000003DC E9 FFFFFF5D                     	JMP	L82
   410 000003E1                                 L105:
   411 000003E1 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   412 000003E8 E9 FFFFFED7                     	JMP	L75
   413 000003ED                                 L104:
   414 000003ED C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   415 000003F4 E9 FFFFFEC1                     	JMP	L74
   416 000003F9                                 	GLOBAL	_sheet_updown
   417 000003F9                                 _sheet_updown:
   418 000003F9 55                              	PUSH	EBP
   419 000003FA 89 E5                           	MOV	EBP,ESP
   420 000003FC 57                              	PUSH	EDI
   421 000003FD 56                              	PUSH	ESI
   422 000003FE 53                              	PUSH	EBX
   423 000003FF 51                              	PUSH	ECX
   424 00000400 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   425 00000403 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   426 00000406 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   427 00000409 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   428 0000040C 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   429 0000040F 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   430 00000412 40                              	INC	EAX
   431 00000413 39 C3                           	CMP	EBX,EAX
   432 00000415 7E 02                           	JLE	L110
   433 00000417 89 C3                           	MOV	EBX,EAX
   434 00000419                                 L110:
   435 00000419 83 FB FF                        	CMP	EBX,-1
   436 0000041C 7D 03                           	JGE	L111
   437 0000041E 83 CB FF                        	OR	EBX,-1
   438 00000421                                 L111:
   439 00000421 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   440 00000424 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   441 00000427 0F 8E 000000A9                  	JLE	L112
   442 0000042D 83 FB 01                        	CMP	EBX,1
   443 00000430 7E 5C                           	JLE	L113
   444 00000432 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   445 00000435                                 L118:
   446 00000435 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   447 00000439 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   448 0000043D 89 48 18                        	MOV	DWORD [24+EAX],ECX
   449 00000440 49                              	DEC	ECX
   450 00000441 39 D9                           	CMP	ECX,EBX
   451 00000443 7F F0                           	JG	L118
   452 00000445 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   453 00000449 43                              	INC	EBX
   454 0000044A 53                              	PUSH	EBX
   455 0000044B 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   456 0000044E 89 C8                           	MOV	EAX,ECX
   457 00000450 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   458 00000453 50                              	PUSH	EAX
   459 00000454 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   460 00000457 89 D0                           	MOV	EAX,EDX
   461 00000459 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   462 0000045C 50                              	PUSH	EAX
   463 0000045D 51                              	PUSH	ECX
   464 0000045E 52                              	PUSH	EDX
   465 0000045F 56                              	PUSH	ESI
   466 00000460 E8 FFFFFC90                     	CALL	_sheet_refreshmap
   467 00000465 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   468 00000468                                 L148:
   469 00000468 53                              	PUSH	EBX
   470 00000469                                 L147:
   471 00000469 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   472 0000046C 89 C8                           	MOV	EAX,ECX
   473 0000046E 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   474 00000471 50                              	PUSH	EAX
   475 00000472 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   476 00000475 89 D0                           	MOV	EAX,EDX
   477 00000477 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   478 0000047A 50                              	PUSH	EAX
   479 0000047B 51                              	PUSH	ECX
   480 0000047C 52                              	PUSH	EDX
   481 0000047D 56                              	PUSH	ESI
   482 0000047E E8 FFFFFE13                     	CALL	_sheet_refreshsub
   483 00000483 83 C4 34                        	ADD	ESP,52
   484 00000486                                 L109:
   485 00000486 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   486 00000489 5B                              	POP	EBX
   487 0000048A 5E                              	POP	ESI
   488 0000048B 5F                              	POP	EDI
   489 0000048C 5D                              	POP	EBP
   490 0000048D C3                              	RET
   491 0000048E                                 L113:
   492 0000048E 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   493 00000491 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   494 00000494 7E 18                           	JLE	L120
   495 00000496 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   496 00000499 39 C1                           	CMP	ECX,EAX
   497 0000049B 7D 11                           	JGE	L120
   498 0000049D                                 L125:
   499 0000049D 8B 44 8E 1C                     	MOV	EAX,DWORD [28+ESI+ECX*4]
   500 000004A1 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   501 000004A5 89 48 18                        	MOV	DWORD [24+EAX],ECX
   502 000004A8 41                              	INC	ECX
   503 000004A9 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   504 000004AC 7C EF                           	JL	L125
   505 000004AE                                 L120:
   506 000004AE FF 4E 10                        	DEC	DWORD [16+ESI]
   507 000004B1 6A 00                           	PUSH	0
   508 000004B3 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   509 000004B6 89 C8                           	MOV	EAX,ECX
   510 000004B8 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   511 000004BB 50                              	PUSH	EAX
   512 000004BC 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   513 000004BF 89 D0                           	MOV	EAX,EDX
   514 000004C1 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   515 000004C4 50                              	PUSH	EAX
   516 000004C5 51                              	PUSH	ECX
   517 000004C6 52                              	PUSH	EDX
   518 000004C7 56                              	PUSH	ESI
   519 000004C8 E8 FFFFFC28                     	CALL	_sheet_refreshmap
   520 000004CD 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   521 000004D0 48                              	DEC	EAX
   522 000004D1 50                              	PUSH	EAX
   523 000004D2 6A 00                           	PUSH	0
   524 000004D4 EB 93                           	JMP	L147
   525 000004D6                                 L112:
   526 000004D6 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   527 000004D9 7D AB                           	JGE	L109
   528 000004DB 83 7D F0 01                     	CMP	DWORD [-16+EBP],1
   529 000004DF 7E 3C                           	JLE	L128
   530 000004E1 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   531 000004E4 39 D9                           	CMP	ECX,EBX
   532 000004E6 7D 10                           	JGE	L144
   533 000004E8                                 L133:
   534 000004E8 8B 44 8E 1C                     	MOV	EAX,DWORD [28+ESI+ECX*4]
   535 000004EC 89 44 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EAX
   536 000004F0 89 48 18                        	MOV	DWORD [24+EAX],ECX
   537 000004F3 41                              	INC	ECX
   538 000004F4 39 D9                           	CMP	ECX,EBX
   539 000004F6 7C F0                           	JL	L133
   540 000004F8                                 L144:
   541 000004F8 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   542 000004FC                                 L134:
   543 000004FC 53                              	PUSH	EBX
   544 000004FD 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   545 00000500 89 C8                           	MOV	EAX,ECX
   546 00000502 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   547 00000505 50                              	PUSH	EAX
   548 00000506 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   549 00000509 89 D0                           	MOV	EAX,EDX
   550 0000050B 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   551 0000050E 50                              	PUSH	EAX
   552 0000050F 51                              	PUSH	ECX
   553 00000510 52                              	PUSH	EDX
   554 00000511 56                              	PUSH	ESI
   555 00000512 E8 FFFFFBDE                     	CALL	_sheet_refreshmap
   556 00000517 53                              	PUSH	EBX
   557 00000518 E9 FFFFFF4B                     	JMP	L148
   558 0000051D                                 L128:
   559 0000051D 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   560 00000520 39 D9                           	CMP	ECX,EBX
   561 00000522 7C 13                           	JL	L146
   562 00000524                                 L139:
   563 00000524 8B 54 8E 18                     	MOV	EDX,DWORD [24+ESI+ECX*4]
   564 00000528 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   565 0000052B 89 54 8E 1C                     	MOV	DWORD [28+ESI+ECX*4],EDX
   566 0000052F 49                              	DEC	ECX
   567 00000530 89 42 18                        	MOV	DWORD [24+EDX],EAX
   568 00000533 39 D9                           	CMP	ECX,EBX
   569 00000535 7D ED                           	JGE	L139
   570 00000537                                 L146:
   571 00000537 89 7C 9E 18                     	MOV	DWORD [24+ESI+EBX*4],EDI
   572 0000053B FF 46 10                        	INC	DWORD [16+ESI]
   573 0000053E EB BC                           	JMP	L134
   574 00000540                                 	GLOBAL	_sheet_refresh
   575 00000540                                 _sheet_refresh:
   576 00000540 55                              	PUSH	EBP
   577 00000541 89 E5                           	MOV	EBP,ESP
   578 00000543 53                              	PUSH	EBX
   579 00000544 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   580 00000547 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   581 0000054A 85 C0                           	TEST	EAX,EAX
   582 0000054C 78 27                           	JS	L149
   583 0000054E 50                              	PUSH	EAX
   584 0000054F 50                              	PUSH	EAX
   585 00000550 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   586 00000553 89 C8                           	MOV	EAX,ECX
   587 00000555 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   588 00000558 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   589 0000055B 50                              	PUSH	EAX
   590 0000055C 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   591 0000055F 89 D0                           	MOV	EAX,EDX
   592 00000561 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   593 00000564 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   594 00000567 50                              	PUSH	EAX
   595 00000568 51                              	PUSH	ECX
   596 00000569 52                              	PUSH	EDX
   597 0000056A FF 73 20                        	PUSH	DWORD [32+EBX]
   598 0000056D E8 FFFFFD24                     	CALL	_sheet_refreshsub
   599 00000572 83 C4 1C                        	ADD	ESP,28
   600 00000575                                 L149:
   601 00000575 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   602 00000578 C9                              	LEAVE
   603 00000579 C3                              	RET
   604 0000057A                                 	GLOBAL	_sheet_refreshall
   605 0000057A                                 _sheet_refreshall:
   606 0000057A 55                              	PUSH	EBP
   607 0000057B 89 E5                           	MOV	EBP,ESP
   608 0000057D 5D                              	POP	EBP
   609 0000057E C3                              	RET
   610 0000057F                                 	GLOBAL	_sheet_slide
   611 0000057F                                 _sheet_slide:
   612 0000057F 55                              	PUSH	EBP
   613 00000580 89 E5                           	MOV	EBP,ESP
   614 00000582 57                              	PUSH	EDI
   615 00000583 56                              	PUSH	ESI
   616 00000584 53                              	PUSH	EBX
   617 00000585 53                              	PUSH	EBX
   618 00000586 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   619 00000589 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   620 0000058C 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   621 0000058F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   622 00000592 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   623 00000595 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   624 00000598 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   625 0000059B 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   626 0000059E 89 43 10                        	MOV	DWORD [16+EBX],EAX
   627 000005A1 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   628 000005A5 7E 7C                           	JLE	L152
   629 000005A7 6A 00                           	PUSH	0
   630 000005A9 89 F0                           	MOV	EAX,ESI
   631 000005AB 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   632 000005AE 50                              	PUSH	EAX
   633 000005AF 89 F8                           	MOV	EAX,EDI
   634 000005B1 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   635 000005B4 50                              	PUSH	EAX
   636 000005B5 56                              	PUSH	ESI
   637 000005B6 57                              	PUSH	EDI
   638 000005B7 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   639 000005BA E8 FFFFFB36                     	CALL	_sheet_refreshmap
   640 000005BF 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   641 000005C2 FF 73 18                        	PUSH	DWORD [24+EBX]
   642 000005C5 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   643 000005C8 50                              	PUSH	EAX
   644 000005C9 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   645 000005CC 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   646 000005CF 50                              	PUSH	EAX
   647 000005D0 FF 75 10                        	PUSH	DWORD [16+EBP]
   648 000005D3 FF 75 0C                        	PUSH	DWORD [12+EBP]
   649 000005D6 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   650 000005D9 E8 FFFFFB17                     	CALL	_sheet_refreshmap
   651 000005DE 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   652 000005E1 83 C4 30                        	ADD	ESP,48
   653 000005E4 48                              	DEC	EAX
   654 000005E5 50                              	PUSH	EAX
   655 000005E6 89 F0                           	MOV	EAX,ESI
   656 000005E8 6A 00                           	PUSH	0
   657 000005EA 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   658 000005ED 50                              	PUSH	EAX
   659 000005EE 89 F8                           	MOV	EAX,EDI
   660 000005F0 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   661 000005F3 50                              	PUSH	EAX
   662 000005F4 56                              	PUSH	ESI
   663 000005F5 57                              	PUSH	EDI
   664 000005F6 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   665 000005F9 E8 FFFFFC98                     	CALL	_sheet_refreshsub
   666 000005FE 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   667 00000601 FF 73 18                        	PUSH	DWORD [24+EBX]
   668 00000604 FF 73 18                        	PUSH	DWORD [24+EBX]
   669 00000607 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   670 0000060A 50                              	PUSH	EAX
   671 0000060B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   672 0000060E 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   673 00000611 50                              	PUSH	EAX
   674 00000612 FF 75 10                        	PUSH	DWORD [16+EBP]
   675 00000615 FF 75 0C                        	PUSH	DWORD [12+EBP]
   676 00000618 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   677 0000061B E8 FFFFFC76                     	CALL	_sheet_refreshsub
   678 00000620 83 C4 38                        	ADD	ESP,56
   679 00000623                                 L152:
   680 00000623 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   681 00000626 5B                              	POP	EBX
   682 00000627 5E                              	POP	ESI
   683 00000628 5F                              	POP	EDI
   684 00000629 5D                              	POP	EBP
   685 0000062A C3                              	RET
   686 0000062B                                 	GLOBAL	_sheet_free
   687 0000062B                                 _sheet_free:
   688 0000062B 55                              	PUSH	EBP
   689 0000062C 89 E5                           	MOV	EBP,ESP
   690 0000062E 53                              	PUSH	EBX
   691 0000062F 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   692 00000632 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   693 00000636 7E 10                           	JLE	L155
   694 00000638 83 7B 1C 66                     	CMP	DWORD [28+EBX],102
   695 0000063C 74 0A                           	JE	L155
   696 0000063E 6A FF                           	PUSH	-1
   697 00000640 53                              	PUSH	EBX
   698 00000641 E8 FFFFFDB3                     	CALL	_sheet_updown
   699 00000646 58                              	POP	EAX
   700 00000647 5A                              	POP	EDX
   701 00000648                                 L155:
   702 00000648 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   703 0000064F 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   704 00000652 C9                              	LEAVE
   705 00000653 C3                              	RET
